<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title th:text="${baiViet.tieuDe}">Chi tiết bài viết</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/LayoutUser.css" />
    <link rel="stylesheet" href="/css/xemchitiet.css" />
</head>
<body>

<!-- Header -->
<div th:replace="LayoutUser :: pHeader"></div>

<!-- Nội dung -->
<div class="container bai-viet-container mt-4">
    <div class="row">
        <!-- Bên trái: Nội dung bài viết -->
        <div class="col-md-8">
            <!-- Hình ảnh -->
            <div class="image-container text-center mb-4" th:if="${baiViet.hinhAnh != null and baiViet.hinhAnh != ''}">
                <img th:src="@{'/images/' + ${baiViet.hinhAnh}}" alt="Hình ảnh bài viết"
                     class="img-fluid featured-image" />
            </div>

            <!-- Breadcrumb -->
            <div class="breadcrumb-custom text-uppercase text-muted text-center small">
                BLOG THÚ CƯNG / <span th:text="${baiViet.loaiBaiViet.tenLoai}">Loại bài viết</span>
            </div>

            <!-- Tiêu đề + Ngày đăng -->
            <h1 class="title text-center mt-2 mb-1" th:text="${baiViet.tieuDe}">Tiêu đề bài viết</h1>
            <p class="text-center text-muted" th:text="${#temporals.format(baiViet.ngayDang, 'MMMM dd, yyyy')}">Ngày đăng</p>

            <!-- Nội dung -->
            <div class="noi-dung-bai-viet" th:utext="${baiViet.noiDung}">
                Nội dung bài viết sẽ hiển thị ở đây.
            </div>

            <!-- Bình luận -->
            <div class="comments-section mt-5">
                <h4 class="mb-3">Bình luận</h4>
                <div style="max-height: 500px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin-bottom: 20px;">
                    <div th:if="${#lists.isEmpty(danhSachBinhLuan)}">
                        <p>Chưa có bình luận nào.</p>
                    </div>
                    <div th:each="bl : ${danhSachBinhLuan}">
                        <div class="mb-3 border-bottom pb-2">
                            <p><strong th:text="${bl.nguoiDung.hoTen}">Người dùng</strong> 
                                <small class="text-muted" th:text="${#temporals.format(bl.ngayBinhLuan, 'dd/MM/yyyy HH:mm')}">Ngày giờ</small>
                            </p>
                            <p th:text="${bl.noiDung}">Nội dung bình luận...</p>
                        </div>
                    </div>
                </div>

                <h5>Để lại bình luận</h5>
                <form th:action="@{/baiviet/{maBaiViet}/binhluan(maBaiViet=${baiViet.maBaiViet})}" th:object="${binhLuanMoi}" method="post">
                    <textarea class="form-control" th:field="*{noiDung}" rows="4" placeholder="Viết bình luận của bạn..."></textarea>
                    <button type="submit" class="btn btn-primary mt-2">Gửi bình luận</button>
                </form>
            </div>

            <!-- Nút quay lại -->
            <div class="mt-5 text-center">
                <a href="/trangchu" class="btn btn-outline-secondary">← Quay lại trang chủ</a>
            </div>
        </div>

        <!-- Bên phải: Xem thêm bài viết -->
        <div class="col-md-4 mt-4 mt-md-0">
            <h5 class="fw-bold mb-3">XEM THÊM</h5>
            <div th:each="baiViet : ${baiVietLienQuan}" class="mb-4 border-bottom pb-3">
                <div class="d-flex">
                    <img th:if="${baiViet.hinhAnh != null and baiViet.hinhAnh != ''}"
                         th:src="@{'/images/' + ${baiViet.hinhAnh}}"
                         alt="Ảnh nhỏ" class="img-thumbnail me-2"
                         style="width: 80px; height: 80px; object-fit: cover; border-radius: 5px;">
                    <div>
                        <a th:href="@{'/baiviet/' + ${baiViet.maBaiViet}}" th:text="${baiViet.tieuDe}"
                           class="text-dark fw-semibold small d-block mb-1">Tiêu đề bài viết</a>
                        <p class="text-muted small mb-0" th:text="${#strings.abbreviate(baiViet.noiDung, 60)}">Tóm tắt</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<div th:replace="LayoutUser :: pFooter"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
